%% \newcommand{\qedsymbol}{...}% \begin{calculus}% \begin{calculus}[$\implies$\ \ ]% \begin{calculus}[$\implies$\ \ ]<3pt> % 3 pt extra skip between lines% \hyphen{1}\proofcase{...A...}\\[1ex]               --- ...A...            % text mode% \hyphen{2}\proofcase{...B...}\\[1ex]               --  ...B...            % text mode% \hyphen{3}\formula{...e...}\\                      -   ...e...            % math mode% =  \formula{...f...}\\                             =   ...f...            % math mode% =  \explanation{...C...}\\                         =   [...C...]          % text mode%    \rightexplanation{...C...}\\                                 [...C...] % text mode% =  \discussion{...C...}\\                          =   ...C...            % text mode (explanation without parentheses)%    \formula{...g...}\\                                 ...g...% =  \formulaexplanation{..k..}{..C..}\\             =   ...k...  [...C...]%    \indentformula{...g'...}\\                              ...g'...%    \indentformula{...g''...}\\                             ...g''...% =  \numberedexplanation{...D...}\label{l}\\             =   [...D...]            (n) % \ref(l)   is n%    \numberedformula{...h...}\label{l'}\\                    ...g...            (n+1) % \ref{l'}  is n+1% =  \numberedrightexplanation{...D...}\label{l''}\\      =      [...D...]       (n+2) % \ref(l'') is n+2% =  \numberedformulaexplanation{..k..}{..C..}\label{m}\\ =   ...k...  [...C...] (n+3) % \ref(m)   is n+3% ...                                                    ...%    \formule{...h...}                                   ...h...            % or \formule{...h...}\\%    \lastformula{...i...}{\qedsymbol}                   ...i...   []%    \lastexplanation{...i...}{\qedsymbol}               ...i...   []%    \lastformulaexplanation{...j...}{..D..}{\qedsymbol} ...k...  [...C...]    []%    \lastnumberedformulaexplanation{...l...}{..E..}{\qedsymbol}\label{l''} ...l...  [...E...] (m) []%    \lastdiscussion{...C...}\\                       =    ...C... []           % text mode (explanation without parentheses)% \end{calculus}   % % The opening and closing parentheses of explanations can be redefined:%    \renewcommand{\openexplanation}{...}    (default $\Lbag$)%    \renewcommand{\closeexplanation}{...}   (default $\Rbag$)% The indentation width of indented formulae can be reset:%    \setlength{\indentformulawidth}{...}     (default 1.5em)%\RequirePackage{stmaryrd}%\def\calculus@trivlist{%  \parsep\z@%  \parskip\z@%  \@nmbrlistfalse%  \@trivlist%  \topsep\z@%  \partopsep\z@%  \itemsep\z@%  \parsep\z@%  \parskip\z@%  \labelwidth\z@%  \labelsep\z@%  \leftmargin\z@%  \rightmargin\z@%  \itemindent\z@%  \listparindent\z@%  \let\@itemlabel\@empty%  \def\makelabel##1{##1}}%\gdef\calculus@tabbing{\let\>\@rtab\let\<\@ltab\let\=\@settab%     \let\+\@tabplus\let\-\@tabminus\let\`\@tabrj\let\'\@tablab%     \let\\=\@tabcr%     \@hightab\@firsttab%     \global\@nxttabmar\@firsttab%     \dimen\@firsttab\@totalleftmargin%     \global\@tabpush\z@ \global\@rjfieldfalse%%     \calculus@trivlist\item\relax%      \setbox\@tabfbox\hbox{%       \rlap{\hskip\@totalleftmargin\indent\the\everypar}}%     \def\@itemfudge{\box\@tabfbox}%     \@startline\ignorespaces}%\gdef\endcalculus@tabbing{%  \@stopline\ifnum\@tabpush>\z@\@badpoptabs\fi\endtrivlist}%\newlength{\calculus@widthexplanation}%\newlength{\calculus@widthlabelledexplanation}%\newlength{\calculus@widthproofcase}%\newlength{\calculus@widthformula}%\newlength{\calculus@widthlabelledformula}%\newlength{\calculus@border}%\newlength{\indentformulawidth}% default indentation of indented formulae\setlength{\indentformulawidth}{1.5em}%\newlength{\calculus@widthindentformula}%\newcommand{\openexplanation}{\ensuremath{\Lbag}}%\newcommand{\closeexplanation}{\ensuremath{\Rbag}}%%\def\calculus@begin@environment{\@ifnextchar[{\calculus@@begin@environment}{\calculus@@begin@environment[${\sqsubseteq}$\ \ ]}}%\def\calculus@@begin@environment[#1]{\@ifnextchar<{\calculus@@@begin@environment[#1]}{\calculus@@@begin@environment[#1]<0pt>}}%\def\calculus@@@begin@environment[#1]<#2>{%% #1: model of left of formulae (default ``${\sqsubseteq}$\ \ '')% #2: default extra skip after \\\begingroup%\let\@@startline\@startline\def\@startline{\vskip #2\@@startline}\newcommand{\calculus@bordersymbol}{{#1}}%\baselineskip1.333\baselineskip%\setlength{\calculus@widthexplanation}{\columnwidth}%\settowidth{\calculus@border}{\calculus@bordersymbol\qquad\openexplanation}%\addtolength{\calculus@widthexplanation}{-\calculus@border}%\setlength{\calculus@widthlabelledexplanation}{\calculus@widthexplanation}%\settowidth{\calculus@border}{\ (999)}%\addtolength{\calculus@widthlabelledexplanation}{-\calculus@border}%\setlength{\calculus@widthformula}{\columnwidth}%\settowidth{\calculus@border}{\calculus@bordersymbol}%\addtolength{\calculus@widthformula}{-\calculus@border}%\setlength{\calculus@widthlabelledformula}{\calculus@widthformula}%\settowidth{\calculus@border}{\quad(99.999)}%\addtolength{\calculus@widthlabelledformula}{-\calculus@border}%\setlength{\calculus@widthindentformula}{\columnwidth}%\settowidth{\calculus@border}{\calculus@bordersymbol}%\addtolength{\calculus@widthindentformula}{-\calculus@border}%\addtolength{\calculus@widthindentformula}{-\indentformulawidth}%%\leavevmode%%\par%%\noindent%\begin{calculus@tabbing}%\calculus@bordersymbol\=\qquad\=\kill%}\newenvironment{calculus}{\calculus@trivlist\item\relax\calculus@begin@environment}{%\end{calculus@tabbing}\endgroup\endtrivlist}%%\newcommand{\hyphen}[1]{%\ifcase#1%\PackageError{calculus}%    {No "hyphen" of level 0}%    {Add one to all level (?-.}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 1.75em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 1.5em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 1.25em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 1.0em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 0.75em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 0.50em}}%\or\noindent\raisebox{0.40ex}{\hbox{\vrule height 0.2ex width 0.25em}}%\else\PackageError{calculus}%    {No "hyphen" of rank > 7}%    {Split calculus to avoid subcases of level > 7 (?).}%\fi}\newcommand{\proofcase}[2]{%\setlength{\calculus@widthproofcase}{\columnwidth}%\settowidth{\calculus@border}{\mbox{}#1\quad\mbox{}}%\addtolength{\calculus@widthproofcase}{-\calculus@border}%\leavevmode\par\noindent#1\quad\parbox[t]{\calculus@widthproofcase}{#2}}%\newcommand{\formula}[1]{\>\parbox[t]{\calculus@widthformula}{$\displaystyle#1$}}%\newcommand{\indentformula}[1]{\>\hskip1.5em\parbox[t]{\calculus@widthindentformula}{$\displaystyle#1$}}%\newcommand{\explanation}[1]{\>\>\openexplanation\parbox[t]{\calculus@widthexplanation}{#1\closeexplanation}}%\newcommand{\discussion}[1]{\>\parbox[t]{\calculus@widthformula}{#1}}%\newcommand{\rightexplanation}[1]{\>\parbox[t]{\calculus@widthformula}{\mbox{}\hfill\openexplanation#1\closeexplanation}}%\newcommand{\formulaexplanation}[2]{\>\parbox[t]{\calculus@widthformula}{$\displaystyle#1$ \hfill\openexplanation{#2}\closeexplanation}}%\newcommand{\indentformulaexplanation}[2]{\>\hskip1.5em\parbox[t]{\calculus@widthindentformula}{$\displaystyle#1$ \hfill\openexplanation{#2}\closeexplanation}}%\newcommand{\lastformula}[2]{\>\parbox[t]{\calculus@widthformula}{$\displaystyle#1$\hfill{#2}}}%\newcommand{\lastdiscussion}[2]{\>\parbox[t]{\calculus@widthformula}{#1\hfill{#2}}}%%\newcommand{\lastformulaexplanation}[3]{\>\parbox[t]{\calculus@widthformula}{$\displaystyle#1$\mbox{}\hfill\openexplanation{#2}\closeexplanation\quad{#3}}}%%\newcommand{\lastrightexplanation}[2]{\>\parbox[t]{\calculus@widthformula}{\mbox{}\hfill\openexplanation#1\closeexplanation\quad{#2}}}%\newcommand{\lastexplanation}[2]{\>\>\openexplanation\parbox[t]{\calculus@widthexplanation}{#1\closeexplanation\hfill{#2}}}%%\let\original@endtabbing\endcalculus@tabbing%\def\calculus@labelledcr{\llap{\@eqnnum}\global\let\\\@tabcr\global\let\endcalculus@tabbing\original@endtabbing\@tabcr}%\def\calculus@labelledendtabbing{\llap{\@eqnnum}\global\let\\\@tabcr\global\let\endcalculus@tabbing\original@endtabbing\endcalculus@tabbing}%%\newcommand{\numberedformula}[1]{%% the production of the equation number must be postponed after the % \label command whence to \\ or \end{calculus} i.e. \endtabbing, the  % initial definition of which must then be restablished.\global\let\\\calculus@labelledcr%\global\let\endcalculus@tabbing\calculus@labelledendtabbing%\stepcounter{equation}%\global\let\@currentlabel=\theequation%\>\parbox[t]{\calculus@widthformula}{\parbox[t]{\calculus@widthlabelledformula}{$\displaystyle#1$}}%}%%\newcommand{\numberedexplanation}[1]{%% the production of the equation number must be postponed after the % \label command whence to \\ or \end{calculus} i.e. \endtabbing, the  % initial definition of which must then be restablished.\global\let\\\calculus@labelledcr%\global\let\endcalculus@tabbing\calculus@labelledendtabbing%\stepcounter{equation}%\global\let\@currentlabel=\theequation%\>\>\openexplanation\parbox[t]{\calculus@widthexplanation}{\parbox[t]{\calculus@widthlabelledexplanation}{#1\closeexplanation}}%}%%\newcommand{\numberedrightexplanation}[1]{%% the production of the equation number must be postponed after the % \label command whence to \\ or \end{calculus} i.e. \endtabbing, the  % initial definition of which must then be restablished.\global\let\\\calculus@labelledcr%\global\let\endcalculus@tabbing\calculus@labelledendtabbing%\stepcounter{equation}%\global\let\@currentlabel=\theequation%\>\parbox[t]{\calculus@widthformula}{\parbox[t]{\calculus@widthlabelledformula}{\mbox{}\hfill\openexplanation#1\closeexplanation}}%}%%\newcommand{\numberedformulaexplanation}[2]{%% the production of the equation number must be postponed after the % \label command whence to \\ or \end{calculus} i.e. \endtabbing, the  % initial definition of which must then be restablished.\global\let\\\calculus@labelledcr%\global\let\endcalculus@tabbing\calculus@labelledendtabbing%\stepcounter{equation}%\global\let\@currentlabel=\theequation%\>\parbox[t]{\calculus@widthformula}{\parbox[t]{\calculus@widthlabelledformula}{$\displaystyle#1$\mbox{}\hfill\openexplanation{#2}\closeexplanation}}%}\def\calculus@lastlabelledendtabbing#1{\llap{\@eqnnum\quad{#1}$\mskip5mu$}\global\let\\\@tabcr\global\let\endcalculus@tabbing\original@endtabbing\endcalculus@tabbing}%\newcommand{\lastnumberedformulaexplanation}[3]{%% the production of the equation number must be postponed after the % \label command whence to \\ or \end{calculus} i.e. \endtabbing, the  % initial definition of which must then be restablished.\global\let\\\calculus@labelledcr%\global\def\endcalculus@tabbing{\calculus@lastlabelledendtabbing{#3}}%\stepcounter{equation}%\global\let\@currentlabel=\theequation%\>\parbox[t]{\calculus@widthformula}{\parbox[t]{\calculus@widthlabelledformula}{$\displaystyle#1$\mbox{}\hfill\openexplanation{#2}\closeexplanation}}%}%% EXPERIMENTAL CODE%%  \begin{eqntabular}{...}	 %    & ...\\%  = & \explain{...}\\%    & ...%  \end{eqntabular}%\newcommand{\explain}[1]{\openexplanation{#1}\closeexplanation}